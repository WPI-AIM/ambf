<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Materials and Textures</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Overview</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chapter15-material.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Materials and Textures </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section15-1"></a>
Introduction</h1>
<p>In this chapter we introduce material and texture properties. These concepts are extensively used in CHAI3D to describe how an object shall appear both visually and haptically.</p>
<h1><a class="anchor" id="section15-2"></a>
Material Properties</h1>
<p>Material properties define how a surface reflects light. They do this by defining color values much the same way that lights do. A material has color values for diffuse (direct) light, ambient (scattered) light, and specular (reflected) light, but these values define how the components of light are reflected off the material surface. The incoming light colors are combined with the corresponding material color and the resulting color is what we see on screen.</p>
<p>These material values have meaning only in relation to the light source(s). For instance if your material reflects ambient light (ie. the material m_ambient setting has a color value), it will still appear as black if there is no ambient light coming from the light source. Similarly, the diffuse material color may be yellow but it will appear greenish if the diffuse light color is green.</p>
<p>The material specular value is usually white, gray or black, because it has no hue of it's own, it is reflecting the hue of the light that is shining on it. Think of this color value as defining the percentage of light that will be reflected.</p>
<p>There is an additional material setting, shininess, that defines the size of the surface reflection. Here is a simple example where we define the ambient, diffuse and specular components of an object.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// setting material properties   </span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_material.m_ambient.set(0.1, 0.1, 0.6);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_material.m_diffuse.set(0.3, 0.3, 0.9);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_material.m_specular.set(1.0, 1.0, 1.0);</div></div><!-- fragment --><p>Some important things to remember about material properties and lighting:</p>
<ul>
<li>Once lighting is enabled, the vertex colors are ignored. OpenGL calculates it's own color values for each vertex, based on the color of the light and the degree of illumination.</li>
<li>Normals are critical to correct lighting. The vertex normals tell OpenGL what angle a plane is at. Based on the angle of the plane with respect to the light and eye positions, OpenGL calculates the reflected light.</li>
<li>Normal lengths matter! They should all be length of 1, or light will fall unevenly. If you are building a mesh and have not defined any vertex normals, simply call function:</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// compute all surface normals</span></div><div class="line">myObject-&gt;computeAllNormals(<span class="keyword">true</span>);</div></div><!-- fragment --><p>Emissive material property typically overrides diffuse, ambient and specular components (unless the glow is very faint). Emissive light is not radiant and doesn't cast light on other objects. You must use another light source to do that.</p>
<p>The level of transparency of an object can be controlled by calling method:</p>
<div class="fragment"><div class="line"><span class="keywordtype">object</span>-&gt;setTransparencyLevel(0.5);</div></div><!-- fragment --><p>In CHAI3D material properties are defined by class <a class="el" href="structchai3d_1_1c_material.html">cMaterial</a>. The class contains a number of graphical and physical constants which allow the programmer to define the way the object are rendered both haptically and graphically.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// GRAPHIC PROPERTIES:</span></div><div class="line"><span class="comment"></span></div><div class="line"><a class="code" href="structchai3d_1_1c_colorf.html">cColorf</a> m_ambient;</div><div class="line"></div><div class="line"><a class="code" href="structchai3d_1_1c_colorf.html">cColorf</a> m_diffuse;</div><div class="line"></div><div class="line"><a class="code" href="structchai3d_1_1c_colorf.html">cColorf</a> m_specular;</div><div class="line"></div><div class="line"><a class="code" href="structchai3d_1_1c_colorf.html">cColorf</a> m_emission;</div><div class="line"></div><div class="line">GLuint m_shininess;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// SURFACE STIFFNESS</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_stiffness;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// DAMPING</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">// Damping level.</span></div><div class="line"><span class="keywordtype">double</span> m_damping;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// VISCOSITY</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_viscosity;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// FRICTION</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_staticFriction;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_dynamicFriction;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// TEXTURE</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_textureLevel;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// VIBRATION</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_vibrationFrequency;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_vibrationAmplitude;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// MAGNET</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_magnetMaxForce;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_magnetMaxDistance;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// STICK AND SLIP</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">double</span> m_stickSlipForceMax;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_stickSlipStiffness;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// HAPTIC MODES</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="keywordtype">bool</span> m_useHapticFriction;</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> m_useHapticTexture;</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> m_useHapticShading;</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> m_hapticFrontSideOfTriangles;</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> m_hapticBackSideOfTriangles;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// SOUND PROPERTIES</span></div><div class="line"><span class="comment"></span></div><div class="line"><a class="code" href="classchai3d_1_1c_audio_buffer.html">cAudioBuffer</a>* m_audioImpactBuffer;</div><div class="line"></div><div class="line"><a class="code" href="classchai3d_1_1c_audio_buffer.html">cAudioBuffer</a>* m_audioFrictionBuffer;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_audioImpactGain;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_audioFrictionGain;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_audioFrictionPitchGain;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> m_audioFrictionPitchOffset;</div></div><!-- fragment --><p>In you further explore the implementation of this class you will discover that <a class="el" href="structchai3d_1_1c_material.html">cMaterial</a> is only a data holder and does not actually contain much code to render objects. Other classes such as force models or haptic effects consult the values stored in the material properties and use them to modulate their results.</p>
<p>Material properties can be defined for each node composing a scene. However this does not mean that all material properties will be used during the rendering pass. If no haptic effects have been programmed for a particular object, then these parameters will have no effect.</p>
<p>The purpose for defining most graphic and haptic in a same container (<a class="el" href="structchai3d_1_1c_material.html">cMaterial</a>) is to facilitate the copying of properties from one object to another.</p>
<h1><a class="anchor" id="section15-3"></a>
Texture Properties</h1>
<p>Texture mapping is a computer graphics capability in which a separate image, referred to as the texture, is stretched onto a piece of 3D geometry and follows it however it is transformed. This image is also known as a texture map. This can be most any image, but its pixel dimensions must be a power of two. (This restriction has been lifted on some graphics cards such as the latest ATI or NVIDIA models) The <b>x</b> and <b>y</b> dimensions do not need to be the same power of two, just a power of two. So, a 128x512 image would work, but a 129x511 image would not.</p>
<div class="image">
<img src="fig-mesh.png" alt="fig-mesh.png"/>
<div class="caption">
Mesh object and mapped Texture properties.</div></div>
<ul>
<li>(a) 3D mesh object of a can. The object is composed on 8138 vertices and 14513 triangles. Gray material properties (ambient, diffuse and specular) are defined.</li>
<li>(b) Texture map image composed of 256 x 128 texels.</li>
<li>(c) Projection of the texture map onto the 3D mesh object. Each vertex carries a position in space (x, y, z) as well as a 2D texture coordinate (s, t).</li>
<li>(d) 3D mesh of a can rendered in wireframe mode.</li>
<li>(e) Combined image illustrating the projection of the texture map onto the mesh.</li>
<li>(f) Illustration of a single triangle, its three vertices and projected texture.</li>
</ul>
<p>Also, to prevent confusion, the texture pixels are not called pixels. A pixel is a dot in the final screen image. A dot in the texture image is called a texture element, or <b>texel</b>. Similarly, to avoid terminology confusion, a texture's width and height dimensions are not called <b>x</b> and <b>y</b>. They are called <b>s</b> and <b>t</b>. A texture map is not generally indexed by its actual resolution coordinates. Instead, it is indexed by a coordinate system that is resolution-independent. The left side is always <b>s = 0</b>, the right side is <b>s = 1</b>, the bottom is <b>t = 0</b>, and the top is <b>t = 1</b>. Thus, you do not need to be aware of the texture's resolution when you are specifying coordinates that point into it. Think of <b>s</b> and <b>t</b> as a measure of what fraction of the way you are into the texture.</p>
<p>In CHAI3D texture properties are defined by classes <a class="el" href="classchai3d_1_1c_texture1d.html">cTexture1d</a>, <a class="el" href="classchai3d_1_1c_texture2d.html">cTexture2d</a>, and <a class="el" href="classchai3d_1_1c_texture3d.html">cTexture3d</a>. Each class contains a number of attributes which allow the programmer to define the exact way the texture is mapped to the object.</p>
<p>In the following example we demonstrate how to load texture in memory and apply it to a square composed of two triangles.</p>
<div class="fragment"><div class="line"><span class="comment">// create a mesh</span></div><div class="line"><span class="keywordtype">object</span> = <span class="keyword">new</span> cMesh();</div><div class="line"></div><div class="line"><span class="comment">// add object to world</span></div><div class="line">world-&gt;addChild(<span class="keywordtype">object</span>);</div><div class="line"></div><div class="line"><span class="comment">// create 4 vertices</span></div><div class="line"><span class="keywordtype">int</span> vertex0 = <span class="keywordtype">object</span>-&gt;newVertex();</div><div class="line"><span class="keywordtype">int</span> vertex1 = <span class="keywordtype">object</span>-&gt;newVertex();</div><div class="line"><span class="keywordtype">int</span> vertex2 = <span class="keywordtype">object</span>-&gt;newVertex();</div><div class="line"><span class="keywordtype">int</span> vertex3 = <span class="keywordtype">object</span>-&gt;newVertex();</div><div class="line"></div><div class="line"><span class="comment">// assign position, surface normal, and texture coordinates to each vertex</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setLocalPos(vertex0,-0.1,-0.1, 0.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setNormal(vertex0, 0.0, 0.0, 1.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setTexCoord(vertex0, 0.0, 0.0);</div><div class="line"></div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setLocalPos(vertex1, 0.1,-0.1, 0.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setNormal(vertex1, 0.0, 0.0, 1.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setTexCoord(vertex1, 1.0, 0.0);</div><div class="line"></div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setLocalPos(vertex2, 0.1, 0.1, 0.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setNormal(vertex2, 0.0, 0.0, 1.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setTexCoord(vertex2, 1.0, 1.0);</div><div class="line"></div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setLocalPos(vertex3,-0.1, 0.1, 0.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setNormal(vertex3, 0.0, 0.0, 1.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_vertices-&gt;setTexCoord(vertex3, 0.0, 1.0);</div><div class="line"></div><div class="line"><span class="comment">// create two triangles by assigning their vertex IDs</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_triangles-&gt;newTriangle(vertex0, vertex1, vertex2);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_triangles-&gt;newTriangle(vertex0, vertex2, vertex3);</div><div class="line"></div><div class="line"><span class="comment">// create a texture map</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_texture = cTexture2d::create();</div><div class="line"></div><div class="line"><span class="comment">// load a texture image file    </span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_texture-&gt;loadFromFile(RESOURCE_PATH(<span class="stringliteral">&quot;myTextureFile.jpg&quot;</span>));</div><div class="line"></div><div class="line"><span class="comment">// enable texture mapping</span></div><div class="line"><span class="keywordtype">object</span>-&gt;setUseTexture(<span class="keyword">true</span>);</div><div class="line"></div><div class="line"><span class="comment">// assign a white material color that is modulated with the texture</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_material-&gt;setWhite();</div><div class="line"></div><div class="line"><span class="comment">// assign some haptic properties</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_material-&gt;setStiffness(500);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_material-&gt;setStaticFriction(0.3);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_material-&gt;setDynamicFriction(0.2);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_material-&gt;setTextureLevel(1.0);</div><div class="line"></div><div class="line"><span class="comment">// create a collision detector for this object</span></div><div class="line"><span class="keywordtype">object</span>-&gt;createAABBCollisionDetector(toolRadius);</div></div><!-- fragment --><div class="image">
<img src="fig-texture-squares.png" alt="fig-texture-squares.png"/>
<div class="caption">
Example 14-textures - 4 squares composed each of 4 vertices, 2 triangles, and a texture map.</div></div>
</div></div><!-- contents -->
</div><!-- doc-content -->
